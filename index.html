<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Mi AL_IA_DA — Agente Soldado PNFT (ABJ)</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="manifest" href="manifest.json" />
</head>
<body>
  <header>
    <div class="hdr-left">
      <h1>Mi AL_IA_DA</h1>
      <div class="sub">Generador ABJ · Agente Soldado · PNFT</div>
    </div>
    <div class="hdr-right">
      <label class="small">Modo:
        <select id="agentMode">
          <option value="local">Modo Local (fallback)</option>
          <option value="soldado">Soldado IA (n8n)</option>
        </select>
      </label>
    </div>
  </header>

  <main class="container">
    <section class="card">
      <h3>Configuración & fuentes</h3>
      <p>PNFT Data: <code>pnft-datos-js.js</code> (coloca aquí tu pnft-datos-js.js completo o usa el ya subido).</p>
      <label>Webhook n8n (opcional)</label>
      <input id="n8nUrl" placeholder="https://ejemplo.n8n.cloud/webhook/XXXX" />
      <div style="display:flex;gap:8px;margin-top:8px">
        <button id="saveWebhook" class="btn small">Guardar webhook</button>
        <button id="clearWebhook" class="btn small alt">Eliminar webhook</button>
      </div>
      <p class="hint">Si el webhook no está configurado o falla, la app guarda en cola local y genera un fallback local.</p>
    </section>

    <section class="card grid">
      <div class="left">
        <h3>1. Seleccione niveles (múltiple)</h3>
        <select id="levels" multiple size="8"></select>

        <h3>2. Seleccione hasta 4 áreas</h3>
        <div id="areasContainer" class="chip-container"></div>

        <h3>3. Seleccione saberes (por área)</h3>
        <div id="saberesContainer" class="saberes-box"></div>

        <label>Resultado de Aprendizaje (RDA)</label>
        <textarea id="rda" rows="3">Desarrollar habilidades de pensamiento computacional aplicadas a problemas reales.</textarea>

        <div style="display:flex;gap:8px;margin-top:8px">
          <button id="generateBtn" class="btn">Generar Planeamiento</button>
          <button id="exportAllBtn" class="btn alt">Exportar todo (HTML)</button>
        </div>

        <div style="margin-top:8px">
          <label>Formato de salida (descargar)</label>
          <select id="outputFormat">
            <option value="text">Texto simple</option>
            <option value="html">HTML (formateado)</option>
          </select>
        </div>
      </div>

      <div class="right">
        <h3>Vista previa / Planeamientos generados</h3>
        <div id="plansContainer"></div>

        <h4>Cola offline (pendientes)</h4>
        <div id="queueList" class="queue-box"></div>
      </div>
    </section>

    <section class="card">
      <h3>Ayuda rápida</h3>
      <p>Modo <b>Soldado IA</b>: envía solicitudes al webhook n8n, que debe procesarlas (ej. llamar a OpenAI) y devolver un JSON con campo <code>textoGenerado</code>. Si no hay conexión, las peticiones se ponen en cola en localStorage y se reenvían al reconectarse.</p>
    </section>
  </main>

  <!-- PNFT_DATA: coloca TU archivo pnft-datos-js.js aquí (ya lo subiste previamente).
       Si no lo tienes, deja un archivo pnft-datos-js.js con el objeto PNFT_DATA global. -->
  <script src="pnft-datos-js.js"></script>
  <script src="app.js"></script>
</body>
</html>
